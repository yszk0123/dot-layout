(this["webpackJsonpdot-layout"]=this["webpackJsonpdot-layout"]||[]).push([[0],{10:function(e,t,n){},11:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);n(10),n(11);var r=n(4),o=n(2),a=n(0),c=n.n(a),l=n(7),u=n.n(l),i=500,s=500,d=500/(i+0),f=500/(s+0),b=1,E="state";function y(e){var t=function(e){var t={version:b,data:e};return JSON.stringify(t)}(e);localStorage.setItem(E,t)}function m(){return function(e){try{if(null===e)return null;var t=JSON.parse(e);return null==(n=t)||"object"!==typeof n||n.version!==b?null:t.data}catch(r){return null}var n}(localStorage.getItem(E))}var O=n(1),v=n.n(O),p=function(e){var t=e.className,n=e.children,r=e.disabled,o=e.onClick;return c.a.createElement("button",{className:v()("Button",t),disabled:r,onClick:o},n)},P=function(e){var t=e.onAdd,n=e.onRemove,r=e.onClear,o=e.onRandomize,a=e.onSave,l=e.canRemove;return c.a.createElement("div",{className:"ControlPanel"},c.a.createElement(p,{className:"ControlPanel__button",onClick:t},"Add"),c.a.createElement(p,{className:"ControlPanel__button",onClick:n,disabled:!l},"Remove"),c.a.createElement(p,{className:"ControlPanel__button",onClick:r},"Clear"),c.a.createElement(p,{className:"ControlPanel__button",onClick:o},"Randomize"),c.a.createElement(p,{className:"ControlPanel__button",onClick:a},"Save"))},D=function(e){var t=e.edge,n=e.startNode,r=e.endNode,o=e.selected,l=e.onClick,u=Object(a.useMemo)((function(){return function(e,t){var n=t.x-e.x,r=t.y-e.y,o=Math.sqrt(n*n+r*r);return{x:n/=o,y:r/=o}}(n,r)}),[n,r]),i=Object(a.useCallback)((function(e){e.stopPropagation(),l(t,e)}),[t,l]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("line",{className:v()("EdgeView",{"EdgeView--selected":o}),x1:n.x+36*u.x,y1:n.y+36*u.y,x2:r.x-36*u.x,y2:r.y-36*u.y,markerEnd:"url(#arrow)",onClick:i}))};var C,j=function(e){var t=e.node,n=e.selected,r=e.onClick,l=e.onDoubleClick,u=e.onMouseDown,i=e.onMouseMove,s=e.onMouseUp,d=Object(a.useState)(null),f=Object(o.a)(d,2),b=f[0],E=f[1],y=Object(a.useCallback)((function(e){var n={x:e.clientX,y:e.clientY};E(n),u({node:t,start:n,current:n},e)}),[u,t]),m=Object(a.useCallback)((function(e){if(null!==b){var n={x:e.clientX,y:e.clientY},r={node:t,start:b,current:n};E(null),s(r)}}),[s,t,b]),O=Object(a.useCallback)((function(e){if(null!==b){var n={x:e.clientX,y:e.clientY};i({node:t,start:b,current:n})}}),[i,t,b]);Object(a.useEffect)((function(){return document.body.addEventListener("mouseup",m),function(){document.body.removeEventListener("mouseup",m)}}),[m]),Object(a.useEffect)((function(){if(null!==b)return document.body.addEventListener("mousemove",O),function(){document.body.removeEventListener("mousemove",O)}}),[O,b]);var p=Object(a.useCallback)((function(e){e.stopPropagation(),r(t,e)}),[r,t]),P=Object(a.useCallback)((function(e){e.stopPropagation(),l(t,e)}),[l,t]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("circle",{className:v()("NodeView",{"NodeView--selected":n,dragging:b}),cx:t.x,cy:t.y,r:36,onClick:p,onDoubleClick:P,onMouseDown:y}),c.a.createElement(x,{x:t.x,y:t.y,text:t.text}))},x=function(e){var t=e.x,n=e.y,r=e.text;return c.a.createElement("foreignObject",{className:"NodeView__text",x:t-36,y:n-36,width:72,height:72},c.a.createElement("p",{className:"NodeView__text-inner"},r))},g=function(e){var t=e.children;return c.a.createElement("svg",{className:"Stage",width:500,height:500,viewBox:"".concat(-0," ").concat(-0," ").concat(i+0," ").concat(s+0)},c.a.createElement("defs",null,A,_),t)},A=c.a.createElement("marker",{id:"arrow",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse"},c.a.createElement("path",{d:"M 0 0 L 10 5 L 0 10 z"})),_=c.a.createElement("marker",{id:"dot",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5"},c.a.createElement("circle",{cx:"5",cy:"5",r:"5",fill:"red"}));!function(e){e[e.APP_LOAD=0]="APP_LOAD",e[e.APP_RANDOMIZE=1]="APP_RANDOMIZE",e[e.GRAPH_CLEAR=2]="GRAPH_CLEAR",e[e.NODE_ADD=3]="NODE_ADD",e[e.GRAPH_REMOVE=4]="GRAPH_REMOVE",e[e.NODE_UPDATE=5]="NODE_UPDATE",e[e.GRAPH_SELECT=6]="GRAPH_SELECT",e[e.GRAPH_DESELECT=7]="GRAPH_DESELECT",e[e.EDGE_ADD=8]="EDGE_ADD"}(C||(C={}));var k=n(5),h=n(8);function w(){return Object(h.generate)()}function R(e){return Math.floor(Math.random()*e)}function N(){return function(e){for(var t=[],n=0;n<e;n+=1)t.push(n);return t}(5).map((function(){return{id:w(),x:R(i),y:R(s),text:"sample"}}))}function M(e){var t=function e(t,n){if(0===n.length)return t;var r=t.w/2;var o=t.h/2;var a=t.x+r;var c=t.y+o;var l={box:{x:t.x,y:t.y,w:r,h:o},nodes:[]};var u={box:{x:a,y:t.y,w:r,h:o},nodes:[]};var i={box:{x:t.x,y:c,w:r,h:o},nodes:[]};var s={box:{x:a,y:c,w:r,h:o},nodes:[]};for(var d=0;d<n.length;d+=1){var f=n[d];f.x<=a?f.y<=c?l.nodes.push(f):i.nodes.push(f):f.y<=c?u.nodes.push(f):s.nodes.push(f)}var b=(E=[l,u,i,s],E.slice(0).sort((function(e,t){return e.nodes.length-t.nodes.length}))[0]);var E;return function(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}(n,b.nodes)?b.box:e(b.box,b.nodes)}({x:0,y:0,w:i,h:s},e);return{id:w(),x:t.x+t.w/2,y:t.y+t.h/2,text:""}}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G={nodes:[],edges:[],selectedId:null};function H(e,t){switch(t.type){case C.APP_LOAD:return t.payload.state;case C.APP_RANDOMIZE:return{nodes:N(),edges:[],selectedId:null};case C.GRAPH_CLEAR:return L({},e,{nodes:[],edges:[],selectedId:null});case C.GRAPH_REMOVE:var n=e.nodes.filter((function(t){return t.id!==e.selectedId})),r=e.edges.filter((function(t){return t.id!==e.selectedId&&t.start!==e.selectedId&&t.end!==e.selectedId}));return L({},e,{nodes:n,edges:r});case C.GRAPH_SELECT:var o=t.payload.id;return L({},e,{selectedId:o});case C.GRAPH_DESELECT:return L({},e,{selectedId:null});case C.NODE_ADD:var a=M(e.nodes);return L({},e,{nodes:[].concat(Object(k.a)(e.nodes),[a])});case C.NODE_UPDATE:var c=t.payload.node;return L({},e,{nodes:I(e.nodes,c)});case C.EDGE_ADD:var l=t.payload,u=l.start,i=l.end;if(null===u||u===i||!T(e.nodes,u)||!T(e.nodes,i)||(d=e.edges,f=u,b=i,d.find((function(e){return e.start===f&&e.end===b||e.start===b&&e.end===f}))))return e;var s={id:w(),start:u,end:i};return L({},e,{edges:[].concat(Object(k.a)(e.edges),[s])});default:return e}var d,f,b}function I(e,t){return e.map((function(e){return e.id===t.id?t:e}))}function T(e,t){return!!e.find((function(e){return e.id===t}))}function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=function(){};var X=document.getElementById("root");u.a.render(c.a.createElement((function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],r=t[1],l=Object(a.useState)(!1),u=Object(o.a)(l,2),i=u[0],s=u[1],b=Object(a.useReducer)(H,G),E=Object(o.a)(b,2),O=E[0],v=E[1],p=O.nodes,x=O.edges,A=O.selectedId,_=Object(a.useMemo)((function(){return function(e){var t={};return e.forEach((function(e){t[e.id]=e})),t}(p)}),[p]),k=Object(a.useCallback)((function(){v({type:C.GRAPH_CLEAR})}),[]),h=Object(a.useCallback)((function(){v({type:C.NODE_ADD})}),[]),w=Object(a.useCallback)((function(e,t){t.ctrlKey||t.metaKey?v({type:C.EDGE_ADD,payload:{start:A,end:e.id}}):v({type:C.GRAPH_SELECT,payload:{id:e.id}})}),[A]),R=Object(a.useCallback)((function(e){v({type:C.GRAPH_SELECT,payload:{id:e.id}})}),[]),N=Object(a.useCallback)((function(e){var t=prompt("text");if(null!==t){var n=U({},e,{text:t});v({type:C.NODE_UPDATE,payload:{node:n}})}}),[]),M=Object(a.useCallback)((function(){v({type:C.GRAPH_DESELECT})}),[]),S=Object(a.useCallback)((function(){v({type:C.GRAPH_REMOVE})}),[]),L=Object(a.useCallback)((function(e){var t=e.node;r(t)}),[]),I=Object(a.useCallback)((function(e){null!==n&&(v({type:C.NODE_UPDATE,payload:{node:n}}),r(null),s(!1))}),[n]),T=Object(a.useCallback)((function(e){if(null!==n){var t=function(e){var t=e.node,n=e.start,r=e.current,o=(r.x-n.x)/d,a=(r.y-n.y)/f;return U({},t,{x:Math.floor(t.x+o),y:Math.floor(t.y+a)})}(e);o=t,a=e.node,(o.id!==a.id||o.x!==a.x||o.y!==a.y)&&(r(t),s(!0))}var o,a}),[n]),V=Object(a.useCallback)((function(){y(O)}),[O]),X=Object(a.useCallback)((function(){v({type:C.APP_RANDOMIZE})}),[]);return Object(a.useEffect)((function(){var e=m();null!==e&&v({type:C.APP_LOAD,payload:{state:e}})}),[]),c.a.createElement("div",{className:"App",onClick:M},c.a.createElement(P,{onAdd:h,onRemove:S,onClear:k,onRandomize:X,onSave:V,canRemove:null!==A}),c.a.createElement(g,null,x.map((function(e){return c.a.createElement(D,{key:e.id,edge:e,startNode:_[e.start],endNode:_[e.end],selected:A===e.id,onClick:R})})),p.map((function(e){return c.a.createElement(j,{key:e.id,node:e,selected:A===e.id,onClick:w,onDoubleClick:N,onMouseDown:L,onMouseUp:I,onMouseMove:T})})),i&&null!==n&&c.a.createElement(j,{key:n.id,node:n,selected:!1,onClick:B,onDoubleClick:B,onMouseDown:B,onMouseUp:B,onMouseMove:B})))}),null),X)},9:function(e,t,n){e.exports=n(24)}},[[9,1,2]]]);
//# sourceMappingURL=main.ce63d3d9.chunk.js.map